# ğŸ§© Cangyun Multi-Modal RAG Agent â€” å¼€å‘ä»»åŠ¡æ¸…å•

## ğŸ Phase 1ï¼šæ–‡å­— RAGï¼ˆW1â€“W6ï¼‰

### âš™ï¸ åŸºåº§ä¸åŸºç¡€è®¾æ–½

- [ ] **[infra]** åˆå§‹åŒ– Monorepo ä¸ CI/CDï¼ˆMonorepo/pnpm workspace å·²å®Œæˆï¼ŒGitHub Actions å·¥ä½œæµå¾…è¡¥ï¼‰
- [x] **[web]** å‰ç«¯è„šæ‰‹æ¶ Vite + React + TS + Tailwind + shadcn/uiï¼ˆ`apps/web` è·¯ç”±ä¸ Chat ç•Œé¢å·²å°±ç»ªï¼‰
- [ ] **[api]** NestJS åŸºåº§é¡¹ç›® + `/healthz` + å…¨å±€éªŒè¯ä¸å¼‚å¸¸è¿‡æ»¤ï¼ˆåŸºç¡€æ¨¡å—å·²åˆå¹¶ï¼Œå¥åº·æ£€æŸ¥ä¸å…¨å±€ç®¡é“æœªé…ç½®ï¼‰
- [x] **[ai]** AI Provider æŠ½è±¡å±‚ï¼ˆOpenAI å®ç° + æ–‡æœ¬ç”Ÿæˆ/æµå¼è¾“å‡º/embeddingï¼‰
- [ ] **[infra]** OpenTelemetry + Sentry é›†æˆ
- [ ] **[infra]** é€Ÿç‡é™åˆ¶ä¸åŒ¿å Session ç®¡ç†

### ğŸ“š çŸ¥è¯†åº“ç³»ç»Ÿ

- [x] **[knowledge]** è¯­é›€æ‘„å–è„šæœ¬ + Markdown å¯¼å…¥å™¨ï¼ˆPlaywright â†’ Markdown/OCR â†’ `pnpm run ingest:markdown` è°ƒç”¨ `/api/v1/knowledge/documents`ï¼‰
- [x] **[knowledge]** å‘é‡ç´¢å¼•ï¼ˆpgvector + OpenAI Embeddingsï¼‰
- [x] **[knowledge]** å¢é‡æ›´æ–°æœºåˆ¶ï¼ˆupsert + index versionï¼‰

### ğŸ’¬ Chat æ¨¡å—ï¼ˆRAGï¼‰

- [x] **[chat]** RAG ç¼–æ’å™¨ä¸æç¤ºæ¨¡æ¿ï¼ˆé›†æˆ `fetch_current_season_guide`ã€`cangyun_search`ã€`cangyun_fetch_page` å·¥å…·å¹¶å†™å…¥ sources å¼•ç”¨ï¼‰
- [x] **[chat]** SSE æµå¼èŠå¤©æ¥å£ `/api/v1/chat`
- [x] **[web]** Chat UIï¼ˆè‡ªå®šä¹‰ `CustomChatTransport`ã€æ¶ˆæ¯æµå¼æ¸²æŸ“ + å¼•ç”¨æ¥æº + topK è°ƒèŠ‚ + ç«‹å³ä¸­æ–­ï¼‰
- [ ] **[chat/test]** æ£€ç´¢æ•ˆæœè¯„ä¼°ï¼ˆé»„é‡‘é—®ç­”é›†ï¼‰
- [ ] **[chat]** ç­”æ¡ˆç¼“å­˜ï¼ˆRedis ç¼“å­˜å±‚ï¼‰

### ğŸ“„ æ–‡æ¡£ä¸éƒ¨ç½²

- [ ] **[docs]** CONTRIBUTING.md + `.env.example` + æœ¬åœ°è¿è¡Œè¯´æ˜ï¼ˆREADMEã€`backend/README`ã€`.env.example` å·²è¯´æ˜ Perplexity/Guide/OCRï¼Œè´¡çŒ®æŒ‡å—ä»ç¼ºï¼‰
- [ ] **[ops]** éƒ¨ç½²æµæ°´çº¿ï¼ˆVercel + Supabase + Upstashï¼‰

---

## ğŸ–¼ï¸ Phase 2ï¼šå›¾åƒè¯†åˆ« & å¾ªç¯ç»Ÿè®¡ï¼ˆW7â€“W12ï¼‰

### ğŸ§© ä¸Šä¼ ä¸åˆ†ææ¥å£

- [ ] **[web]** å›¾ç‰‡ä¸Šä¼  UIï¼ˆæ‹–æ‹½ + ç±»å‹é€‰æ‹© + é¢„è§ˆï¼‰
- [ ] **[image]** `/api/v1/analyze/image` æ¥å£ï¼ˆmultipart + è¿”å›å»ºè®®ï¼‰

### ğŸ” æŠ€èƒ½è¯†åˆ«ç³»ç»Ÿ

- [ ] **[image]** OCR é€‚é…å±‚ï¼ˆäº‘ç«¯ä¼˜å…ˆ + Tesseract å…œåº•ï¼‰
- [ ] **[image]** æŠ€èƒ½å›¾æ ‡æ¨¡æ¿åŒ¹é… + Vision Fallback
- [ ] **[image]** æŠ€èƒ½è¯†åˆ« â†’ çŸ¥è¯†è”åŠ¨ï¼ˆåŒ¹é…çŸ¥è¯†åº“å†…å®¹ï¼‰

### ğŸ“Š è¾“å‡ºå¾ªç¯ç»Ÿè®¡åˆ†æ

- [ ] **[image]** é¢æ¿/è¡¨æ ¼å¸ƒå±€è§£æå™¨ï¼ˆRotation Statsï¼‰
- [ ] **[ai]** å¾ªç¯è´¨é‡è¯„ä¼°å¼•æ“ï¼ˆè§„åˆ™ + LLM æ–‡æ¡ˆï¼‰
- [ ] **[web]** åˆ†æç»“æœå±•ç¤ºï¼ˆè¦ç‚¹å¡ç‰‡ + å»ºè®®é«˜äº®ï¼‰

### ğŸ§° ç¨³å®šæ€§ä¸è´¨é‡

- [ ] **[infra]** åª’ä½“ä¸´æ—¶å­˜å‚¨ + TTL æ¸…ç†æœºåˆ¶
- [ ] **[test]** å›¾åƒè¯†åˆ«å›å½’é›†ï¼ˆ30+ å®ä¾‹æˆªå›¾ï¼‰

---

## ğŸ¥ Phase 3ï¼šè§†é¢‘åˆ†æç³»ç»Ÿï¼ˆW13â€“W16ï¼‰

### ğŸ“¦ ä¸Šä¼ ä¸ä»»åŠ¡ç³»ç»Ÿ

- [ ] **[video]** `/api/v1/analyze/video` æ¥å£ï¼ˆtaskId è¿”å›ï¼‰
- [ ] **[infra]** Redis Streams é˜Ÿåˆ— Workerï¼ˆä»»åŠ¡æµè½¬ç®¡ç†ï¼‰

### ğŸï¸ å¸§æŠ½å–ä¸äº‹ä»¶è¯†åˆ«

- [ ] **[video]** FFmpeg å¸§æå–ç®¡çº¿ï¼ˆå¯é…ç½® fps + è£å‰ªåŒºåŸŸï¼‰
- [ ] **[video]** å¸§è¯†åˆ« â†’ äº‹ä»¶åºåˆ—æ„å»ºï¼ˆtimeline[]ï¼‰

### ğŸ§® å¾ªç¯åˆ†æä¸æŠ¥å‘Š

- [ ] **[ai]** æ—¶é—´è½´æ¯”å¯¹åˆ†æï¼ˆrotation timeline comparatorï¼‰
- [ ] **[web]** è§†é¢‘åˆ†ææŠ¥å‘Šä¸æ—¶é—´è½´ UI
- [ ] **[video]** æŸ¥è¯¢æ¥å£ï¼ˆtaskId â†’ report/timelineï¼‰

### âš–ï¸ æ€§èƒ½ä¸é£æ§

- [ ] **[infra]** å¹¶å‘é™æµä¸å…¬å¹³é˜Ÿåˆ—ï¼ˆIP é…é¢ + è¶…æ—¶é‡è¯•ï¼‰
- [ ] **[ops]** æ€§èƒ½ä¸æˆæœ¬åŸºçº¿ï¼ˆp95 < 5minï¼‰

---

## ğŸ›¡ï¸ æ¨ªåˆ‡ä»»åŠ¡ï¼ˆå®‰å…¨ / è´¨é‡ / æ–‡æ¡£ï¼‰

- [ ] **[security]** æ–‡ä»¶å®‰å…¨ä¸ç±»å‹ç™½åå•ï¼ˆé˜²æ³¨å…¥ + æ‰«æï¼‰
- [ ] **[docs]** OpenAPI + ç¤ºä¾‹ï¼ˆchat/image/videoï¼‰
- [ ] **[test]** E2E æµ‹è¯•ï¼ˆPlaywright / Cypressï¼‰

---

## ğŸ—‚ï¸ Milestones

- [ ] **M1** Phase 1 â€” åŸºç¡€æ¡†æ¶ä¸æ–‡å­— RAGï¼ˆ6 å‘¨ï¼‰
- [ ] **M2** Phase 2 â€” å›¾åƒè¯†åˆ«ä¸å¾ªç¯ç»Ÿè®¡ï¼ˆ6 å‘¨ï¼‰
- [ ] **M3** Phase 3 â€” è§†é¢‘åˆ†æä¸æŠ¥å‘Šç³»ç»Ÿï¼ˆ4 å‘¨ï¼‰
